package hu.vadasz.peter.knockmessenger.Adapters;

import android.view.View;

import java.util.List;

import hu.vadasz.peter.knockmessenger.DataPersister.Entities.Friend;

/**
 * This class is the adapter of the RecyclerView which contains friends.
 */

public class FriendsAdapter extends AbstractFriendAdapter {

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// INTERFACES
    ////////////////////////////////////////////////////////////////////////////////////////////////

    /**
     * This interface is implemented by the Activity class which contains the RecyclerView.
     */
    public interface FriendListener {
        void removeFriend(Friend friend);
        void sendMessage(String telephone);
        void confirmDelete(Friend friend);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// INTERFACES -- END
    ////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// FIELDS
    ////////////////////////////////////////////////////////////////////////////////////////////////

    private FriendListener listener;

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// FIELDS -- END
    ////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// CONSTRUCTION
    ////////////////////////////////////////////////////////////////////////////////////////////////

    public FriendsAdapter(List<Friend> friends, FriendListener listener) {
        super(friends);
        this.listener = listener;

    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// CONSTRUCTION -- END
    ////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// AbstractFriendAdapter OVERRIDES
    ////////////////////////////////////////////////////////////////////////////////////////////////

    @Override
    public void setViewItems(final ViewHolder holder, final int position) {
        holder.addFriend.setVisibility(View.GONE);
        holder.removeFriend.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                removeFriend(friends.get(position));
            }
        });

        holder.sendMessage.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                listener.sendMessage(friends.get(holder.getAdapterPosition()).getTel());
            }
        });

        holder.card.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                listener.sendMessage(friends.get(holder.getAdapterPosition()).getTel());
            }
        });
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// AbstractFriendAdapter OVERRIDES -- END
    ////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// CONTENT UTILS
    ////////////////////////////////////////////////////////////////////////////////////////////////

    /**
     * This method is called when an item is deleted by swiping its card.
     * @param position the position of the friend in the friend's list to be deleted.
     */

    public void onItemDismiss(int position) {
        listener.confirmDelete(friends.get(position));
    }

    /**
     * This method is called when a friend is deleted.
     * @param friend the friend to be deleted.
     */

    private void removeFriend(Friend friend) {
        listener.confirmDelete(friend);
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    /// CONTENT UTILS -- END
    ////////////////////////////////////////////////////////////////////////////////////////////////

}
